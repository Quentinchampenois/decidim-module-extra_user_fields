<div class="grid-container full">
  <div class="grid-x grid-margin-x">
    <div class="card-section">
      <button id="createSignupFieldBtn" type="button">New Field</button>
    </div>
  </div>
  <div class="grid-x grid-margin-x card-grid">
    <div class="cell small-6">
      <div class="card">
        <div class="card-section">
          <p class="mb-m"><%= t(".active_fields") %></p>
          <ul class="draggable-list js-connect js-list-actives" data-sort-url="<%= decidim_admin.organization_homepage_path %>">
            <% active_fields.each do |signup_field| %>
              <li draggable="true" data-content-block-manifest-name=<%= signup_field.manifest %>>
                <div class="draggable-content">
                  <%= signup_field.title[current_locale] %>
                  <div>

                    <%= icon "menu", role: "img", "aria-hidden": true %>
                  </div>
                </div>
              </li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
    <div class="cell small-6">
      <div class="card">
        <div class="card-section">
          <p class="mb-m"><%= t(".inactive_fields") %></p>
          <ul class="draggable-list js-connect js-list-availables">
            <% inactive_fields.each do |signup_field| %>
              <li draggable="true" data-content-block-manifest-name="extra-field">
                <div class="draggable-content">
                  <%= signup_field.title[current_locale] %>
                  <div>

                    <%= icon "menu", role: "img", "aria-hidden": true %>
                  </div>
                </div>
              </li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<script>


  $(document).ready(() => {
      $("#submit_extra_fields").on("submit", (event) => {
          event.preventDefault()
          var activeFields = document.querySelectorAll(".js-list-actives li");

          var activeFieldsManifestName = [];
          activeFields.forEach((field) => {
              activeFieldsManifestName.push([field.innerText.trim(), field.dataset.contentBlockManifestName]);
          })

          console.log(activeFieldsManifestName)

      })

      // When clicking the button, we create a new field
      $("#createSignupFieldBtn").on("click", (event) => {
          // Create a new field using the command CreateSignupField
<!--          $.ajax({-->
<!--              method: "POST",-->
<!--              url: "<%# decidim_admin.create_signup_field_path %>",-->
<!--              contentType: "application/json",-->
<!--              data: JSON.stringify({ title: "New field", description: "Salut", required: true, weight: 3, published_at: Date.now() , masked: false, manifest: "text" })-->
<!--          });-->
          // Add the new field to the active fields list
          // document.querySelector(".js-list-actives").appendChild(newField);
      })
  })

</script>
